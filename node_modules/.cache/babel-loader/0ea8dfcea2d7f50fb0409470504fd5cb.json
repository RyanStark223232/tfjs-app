{"ast":null,"code":"/**\r\n * @license\r\n * Copyright 2018 Google LLC. All Rights Reserved.\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n * =============================================================================\r\n */\n\n/** An implementation of the Where kernel shared between cpu and webgl */\nimport { buffer } from '../ops/buffer';\nexport function whereImpl(condShape, condVals) {\n  var indices = [];\n\n  for (var i = 0; i < condVals.length; i++) {\n    if (condVals[i]) {\n      indices.push(i);\n    }\n  }\n\n  var inBuffer = buffer(condShape, 'int32');\n  var out = buffer([indices.length, condShape.length], 'int32');\n\n  for (var _i = 0; _i < indices.length; _i++) {\n    var loc = inBuffer.indexToLoc(indices[_i]);\n    var offset = _i * condShape.length;\n    out.values.set(loc, offset);\n  }\n\n  return out.toTensor();\n}","map":{"version":3,"sources":["../../src/backends/where_impl.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;AAeG;;AAEH;AAEA,SAAQ,MAAR,QAAqB,eAArB;AAIA,OAAM,SAAU,SAAV,CAAoB,SAApB,EAAyC,QAAzC,EAA6D;AACjE,MAAM,OAAO,GAAG,EAAhB;;AACA,OAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,QAAQ,CAAC,MAA7B,EAAqC,CAAC,EAAtC,EAA0C;AACxC,QAAI,QAAQ,CAAC,CAAD,CAAZ,EAAiB;AACf,MAAA,OAAO,CAAC,IAAR,CAAa,CAAb;AACD;AACF;;AAED,MAAM,QAAQ,GAAG,MAAM,CAAC,SAAD,EAAY,OAAZ,CAAvB;AAEA,MAAM,GAAG,GAAG,MAAM,CAAC,CAAC,OAAO,CAAC,MAAT,EAAiB,SAAS,CAAC,MAA3B,CAAD,EAAqC,OAArC,CAAlB;;AACA,OAAK,IAAI,EAAC,GAAG,CAAb,EAAgB,EAAC,GAAG,OAAO,CAAC,MAA5B,EAAoC,EAAC,EAArC,EAAyC;AACvC,QAAM,GAAG,GAAG,QAAQ,CAAC,UAAT,CAAoB,OAAO,CAAC,EAAD,CAA3B,CAAZ;AACA,QAAM,MAAM,GAAG,EAAC,GAAG,SAAS,CAAC,MAA7B;AACA,IAAA,GAAG,CAAC,MAAJ,CAAW,GAAX,CAAe,GAAf,EAAoB,MAApB;AACD;;AACD,SAAO,GAAG,CAAC,QAAJ,EAAP;AACD","sourceRoot":"","sourcesContent":["/**\r\n * @license\r\n * Copyright 2018 Google LLC. All Rights Reserved.\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n * =============================================================================\r\n */\r\n/** An implementation of the Where kernel shared between cpu and webgl */\r\nimport { buffer } from '../ops/buffer';\r\nexport function whereImpl(condShape, condVals) {\r\n    const indices = [];\r\n    for (let i = 0; i < condVals.length; i++) {\r\n        if (condVals[i]) {\r\n            indices.push(i);\r\n        }\r\n    }\r\n    const inBuffer = buffer(condShape, 'int32');\r\n    const out = buffer([indices.length, condShape.length], 'int32');\r\n    for (let i = 0; i < indices.length; i++) {\r\n        const loc = inBuffer.indexToLoc(indices[i]);\r\n        const offset = i * condShape.length;\r\n        out.values.set(loc, offset);\r\n    }\r\n    return out.toTensor();\r\n}\r\n//# sourceMappingURL=where_impl.js.map"]},"metadata":{},"sourceType":"module"}