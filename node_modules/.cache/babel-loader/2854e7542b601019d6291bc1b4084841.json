{"ast":null,"code":"import _toConsumableArray from\"C:/Users/wongh/finger/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"C:/Users/wongh/finger/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/wongh/finger/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:/Users/wongh/finger/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/wongh/finger/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"C:/Users/wongh/finger/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:/Users/wongh/finger/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/wongh/finger/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import React from\"react\";import Button from'@material-ui/core/Button';import*as handpose from\"@tensorflow-models/handpose\";import*as posenet from\"@tensorflow-models/posenet\";import*as facemesh from\"@tensorflow-models/facemesh\";//import * as tf from '@tensorflow/tfjs-core';\nimport Webcam from\"react-webcam\";import\"./App.css\";import{drawHand,writeText,drawKeypoints,drawSkeleton,drawMesh}from\"./utilities\";import{sqrt,pow}from\"mathjs\";import{Line}from'react-chartjs-2';var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.sleep=function(milliseconds){return new Promise(function(resolve){return setTimeout(resolve,milliseconds);});};_this.record_estimateHands=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(img,net,ctx){var hand;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return net.estimateHands(img);case 2:hand=_context.sent;console.log(hand);if(hand.length>0){//drawHand(hand, ctx);   \n_this.setState({dead_frame:0});}else{if(_this.state.dead_frame===1)writeText(ctx,{text:'Hand Off Screen',x:180,y:70});_this.setState({dead_frame:1});}case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x,_x2,_x3){return _ref.apply(this,arguments);};}();_this.state={ID:0,tap_count:[],rotate_count:[],fist_count:[],index_passed:0,rotate_passed:0,last_pressed:0,real_time_inferencing:false,recording:false,button_mode:false,chart_ready:false,finger_done:false,rotate_done:false,fist_done:false,pawn_dist_array:[],pawn_rotate_array:[],pawn_fist_array:[],dist_array:[],dist_time_array:[],dist_record:[],dist_time_record:[],rotate_array:[],rotate_time_array:[],rotate_record:[],rotate_time_record:[],fist_array:[],fist_time_array:[],fist_record:[],fist_time_record:[],gait_record:[],gait_time_record:[],chart_data1:null,chart_data2:null,chart_data3:null,wait:false,wait_till:0,startAt:Date.now(),dead_frame:0,ctx:null,raw:false,facingMode:\"user\"};_this.webcamRef=/*#__PURE__*/React.createRef(null);_this.canvasRef=/*#__PURE__*/React.createRef(null);_this.videoConstraints={facingMode:\"user\"};_this.runHandpose=_this.runHandpose.bind(_assertThisInitialized(_this));_this.stop_real_time_inference=_this.stop_real_time_inference.bind(_assertThisInitialized(_this));_this.stop_tapping=_this.stop_tapping.bind(_assertThisInitialized(_this));_this.stop_rotating=_this.stop_rotating.bind(_assertThisInitialized(_this));_this.stop_record=_this.stop_record.bind(_assertThisInitialized(_this));_this.record_video=_this.record_video.bind(_assertThisInitialized(_this));_this.concat_frame=_this.concat_frame.bind(_assertThisInitialized(_this));_this.inference=_this.inference.bind(_assertThisInitialized(_this));_this.reset_counter=_this.reset_counter.bind(_assertThisInitialized(_this));_this.increment_tap1=_this.increment_tap1.bind(_assertThisInitialized(_this));_this.increment_tap2=_this.increment_tap2.bind(_assertThisInitialized(_this));_this.switch_button=_this.switch_button.bind(_assertThisInitialized(_this));_this.compose_chart=_this.compose_chart.bind(_assertThisInitialized(_this));_this.runPosenet=_this.runPosenet.bind(_assertThisInitialized(_this));_this.read_time_posenet=_this.read_time_posenet.bind(_assertThisInitialized(_this));_this.runFacemesh=_this.runFacemesh.bind(_assertThisInitialized(_this));_this.read_time_facemesh=_this.read_time_facemesh.bind(_assertThisInitialized(_this));_this.switch_style=_this.switch_style.bind(_assertThisInitialized(_this));_this.switch_cam=_this.switch_cam.bind(_assertThisInitialized(_this));return _this;}_createClass(App,[{key:\"switch_cam\",value:function switch_cam(){if(this.state.facingMode===\"user\")this.setState({facingMode:\"environment\"});else if(this.state.facingMode===\"environment\")this.setState({facingMode:\"user\"});}},{key:\"runFacemesh\",value:function(){var _runFacemesh=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _this2=this;var net,Interval_ID;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:require('@tensorflow/tfjs-backend-webgl');_context2.next=3;return facemesh.load();case 3:net=_context2.sent;console.log(\"Facemesh model loaded.\");this.setState({startAt:Date.now()});Interval_ID=setInterval(function(){_this2.read_time_facemesh(net);},50);this.setState({ID:Interval_ID});this.setState({real_time_inferencing:true});case 9:case\"end\":return _context2.stop();}}},_callee2,this);}));function runFacemesh(){return _runFacemesh.apply(this,arguments);}return runFacemesh;}()},{key:\"read_time_facemesh\",value:function(){var _read_time_facemesh=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(net){var video,videoWidth,videoHeight,face,ctx;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:if(this.state.wait){this.setState({wait_till:Date.now()+3000});//await this.sleep(3000);\nthis.setState({wait:false});}if(!(typeof this.webcamRef.current!==\"undefined\"&&this.webcamRef.current!==null&&this.webcamRef.current.video.readyState===4)){_context3.next=14;break;}video=this.webcamRef.current.video;videoWidth=this.webcamRef.current.video.videoWidth;videoHeight=this.webcamRef.current.video.videoHeight;this.webcamRef.current.video.width=videoWidth;this.webcamRef.current.video.height=videoHeight;this.canvasRef.current.width=videoWidth;this.canvasRef.current.height=videoHeight;_context3.next=11;return net.estimateFaces(video);case 11:face=_context3.sent;ctx=this.canvasRef.current.getContext(\"2d\");drawMesh(face,ctx);case 14:case\"end\":return _context3.stop();}}},_callee3,this);}));function read_time_facemesh(_x4){return _read_time_facemesh.apply(this,arguments);}return read_time_facemesh;}()},{key:\"runPosenet\",value:function(){var _runPosenet=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var _this3=this;var net,Interval_ID;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:require('@tensorflow/tfjs-backend-webgl');_context4.next=3;return posenet.load();case 3:net=_context4.sent;console.log(\"PoseNet model loaded.\");this.setState({startAt:Date.now()});Interval_ID=setInterval(function(){_this3.read_time_posenet(net);},50);this.setState({ID:Interval_ID});this.setState({real_time_inferencing:true});case 9:case\"end\":return _context4.stop();}}},_callee4,this);}));function runPosenet(){return _runPosenet.apply(this,arguments);}return runPosenet;}()},{key:\"read_time_posenet\",value:function(){var _read_time_posenet=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(net){var video,videoWidth,videoHeight,pose,ctx;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(this.state.wait){this.setState({wait_till:Date.now()+3000});//await this.sleep(3000);\nthis.setState({wait:false});}if(!(typeof this.webcamRef.current!==\"undefined\"&&this.webcamRef.current!==null&&this.webcamRef.current.video.readyState===4)){_context5.next=15;break;}video=this.webcamRef.current.video;videoWidth=this.webcamRef.current.video.videoWidth;videoHeight=this.webcamRef.current.video.videoHeight;this.webcamRef.current.video.width=videoWidth;this.webcamRef.current.video.height=videoHeight;this.canvasRef.current.width=videoWidth;this.canvasRef.current.height=videoHeight;_context5.next=11;return net.estimateSinglePose(video);case 11:pose=_context5.sent;ctx=this.canvasRef.current.getContext(\"2d\");drawKeypoints(pose[\"keypoints\"],0.6,ctx);drawSkeleton(pose[\"keypoints\"],0.7,ctx);case 15:case\"end\":return _context5.stop();}}},_callee5,this);}));function read_time_posenet(_x5){return _read_time_posenet.apply(this,arguments);}return read_time_posenet;}()},{key:\"switch_style\",value:function(){var _switch_style=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return this.setState({raw:!this.state.raw});case 2:this.compose_chart();case 3:case\"end\":return _context6.stop();}}},_callee6,this);}));function switch_style(){return _switch_style.apply(this,arguments);}return switch_style;}()},{key:\"compose_chart\",value:function compose_chart(){var time_array_1=[];var count_array_1=[];var time_array_2=[];var count_array_2=[];var time_array_3=[];var count_array_3=[];var real_dist=document.getElementById(\"real_measurement\").value;// change to real life measurement\nif(this.state.raw){time_array_1=_toConsumableArray(this.state.dist_time_array);count_array_1=_toConsumableArray(this.state.dist_array);time_array_2=_toConsumableArray(this.state.rotate_time_array);count_array_2=_toConsumableArray(this.state.rotate_array);time_array_3=_toConsumableArray(this.state.fist_time_array);count_array_3=_toConsumableArray(this.state.fist_array);if(real_dist>0.0001){var i=0;var tmp=0;for(i=0;i<count_array_1.length;i++){tmp=count_array_1[i];count_array_1[i]=tmp*real_dist;}for(i=0;i<count_array_2.length;i++){tmp=count_array_2[i];count_array_2[i]=tmp*real_dist;}for(i=0;i<count_array_3.length;i++){tmp=count_array_3[i];count_array_3[i]=tmp*real_dist;}}}else{// Recalculate Tapping Data\nvar start=this.state.dist_time_array[0];var end=this.state.dist_time_array[this.state.dist_time_array.length-1];while(start+1.0<end){time_array_1=[].concat(_toConsumableArray(time_array_1),[start]);var count=0,temp_max=0;for(var _i=0;_i<this.state.dist_array.length;_i++){if(this.state.dist_time_array[_i]>=start&&this.state.dist_time_array[_i]<start+1.0){if(temp_max<this.state.dist_array[_i])temp_max=this.state.dist_array[_i];if(this.state.tap_count.includes(this.state.dist_time_array[_i])){count+=temp_max;temp_max=0;}}}count_array_1=[].concat(_toConsumableArray(count_array_1),[count]);start+=0.1;}// Recalculate Rotate Data\nstart=this.state.rotate_time_array[0];end=this.state.rotate_time_array[this.state.rotate_time_array.length-1];while(start+5.0<end){time_array_2=[].concat(_toConsumableArray(time_array_2),[start+2.5]);var _count=0.0;var time_value=0;for(var tc in this.state.rotate_count){time_value=this.state.rotate_count[tc];if(time_value>=start&&time_value<start+5.0){_count+=1.0;}}count_array_2=[].concat(_toConsumableArray(count_array_2),[_count]);start+=0.1;}// Recalculate Gripping Data\nstart=this.state.fist_time_array[0];end=this.state.fist_time_array[this.state.fist_time_array.length-1];while(start+5.0<end){time_array_3=[].concat(_toConsumableArray(time_array_3),[start+2.5]);var _count2=0.0;var _time_value=0;for(var _tc in this.state.fist_count){_time_value=this.state.fist_count[_tc];if(_time_value>=start&&_time_value<start+5.0){_count2+=1.0;}}count_array_3=[].concat(_toConsumableArray(count_array_3),[_count2]);start+=0.1;}}var data1={labels:time_array_1,datasets:[{label:'Tapping',fill:false,lineTension:0.3,backgroundColor:'rgba(75,192,192,0.4)',borderColor:'rgba(75,192,192,1)',borderCapStyle:'butt',borderDash:[],borderDashOffset:0.0,borderJoinStyle:'miter',pointBorderColor:'rgba(75,192,192,1)',pointBackgroundColor:'#fff',pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:'rgba(75,192,192,1)',pointHoverBorderColor:'rgba(220,220,220,1)',pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:count_array_1}]};var data2={labels:time_array_2,datasets:[{label:'Rotation',fill:false,lineTension:0.1,backgroundColor:'rgba(192,75,192,0.4)',borderColor:'rgba(192,75,192,1)',borderCapStyle:'butt',borderDash:[],borderDashOffset:0.0,borderJoinStyle:'miter',pointBorderColor:'rgba(192,75,192,1)',pointBackgroundColor:'#fff',pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:'rgba(192,75,192,1)',pointHoverBorderColor:'rgba(220,220,220,1)',pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:count_array_2}]};var data3={labels:time_array_3,datasets:[{label:'Fist',fill:false,lineTension:0.1,backgroundColor:'rgba(192,192,75,0.4)',borderColor:'rgba(192,192,75,1)',borderCapStyle:'butt',borderDash:[],borderDashOffset:0.0,borderJoinStyle:'miter',pointBorderColor:'rgba(192,192,75,1)',pointBackgroundColor:'#fff',pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:'rgba(192,192,75,1)',pointHoverBorderColor:'rgba(220,220,220,1)',pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:count_array_3}]};this.setState({chart_data1:data1});this.setState({chart_data2:data2});this.setState({chart_data3:data3});this.setState({chart_ready:true});}},{key:\"switch_button\",value:function switch_button(){if(this.state.button_mode===true){this.setState({button_mode:false});this.compose_chart();}else{this.setState({button_mode:true});}}},{key:\"increment_tap1\",value:function increment_tap1(){if(this.state.last_pressed!==1){var current_moment=(Date.now()-this.state.startAt)/1000;this.setState({last_pressed:1});this.setState({dist_array:[].concat(_toConsumableArray(this.state.dist_array),[1.0])});this.setState({dist_time_array:[].concat(_toConsumableArray(this.state.dist_time_array),[current_moment])});this.setState({tap_count:[].concat(_toConsumableArray(this.state.tap_count),[current_moment])});}}},{key:\"increment_tap2\",value:function increment_tap2(){if(this.state.last_pressed!==2){var current_moment=(Date.now()-this.state.startAt)/1000;this.setState({last_pressed:2});this.setState({dist_array:[].concat(_toConsumableArray(this.state.dist_array),[1.0])});this.setState({dist_time_array:[].concat(_toConsumableArray(this.state.dist_time_array),[current_moment])});this.setState({tap_count:[].concat(_toConsumableArray(this.state.tap_count),[current_moment])});}}},{key:\"norm\",value:function norm(lm1,lm2){return sqrt(pow(lm1[0]-lm2[0],2)+pow(lm1[1]-lm2[1],2));}},{key:\"reset_counter\",value:function reset_counter(){clearInterval(this.state.ID);if(this.state.ctx!=null)this.state.ctx.clearRect(0,0,this.canvasRef.current.width,this.canvasRef.current.height);this.setState({ID:0,tap_count:[],rotate_count:[],fist_count:[],index_passed:0,rotate_passed:0,last_pressed:0,real_time_inferencing:false,recording:false,button_mode:false,chart_ready:false,finger_done:false,rotate_done:false,fist_done:false,dist_array:[],dist_time_array:[],dist_record:[],dist_time_record:[],rotate_array:[],rotate_time_array:[],rotate_record:[],rotate_time_record:[],fist_array:[],fist_time_array:[],fist_record:[],fist_time_record:[],gait_record:[],gait_time_record:[],chart_data1:null,chart_data2:null,chart_data3:null,wait:false,wait_till:0,startAt:Date.now(),dead_frame:0});}},{key:\"runHandpose\",value:function(){var _runHandpose=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){var _this4=this;var ctx,net,Interval_ID;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:ctx=this.canvasRef.current.getContext(\"2d\");writeText(ctx,{text:'Loading',x:180,y:70});require('@tensorflow/tfjs-backend-webgl');_context7.next=5;return handpose.load();case 5:net=_context7.sent;ctx.clearRect(0,0,this.canvasRef.current.width,this.canvasRef.current.height);//const uploadJSONInput = document.getElementById('upload-json');\n//const uploadWeightsInput = document.getElementById('upload-weights');\n//const model = await tf.loadLayersModel(tf.io.browserFiles([uploadJSONInput.files[0], uploadWeightsInput.files[0]]));\nconsole.log(\"Handpose model loaded.\");this.setState({startAt:Date.now()});Interval_ID=setInterval(function(){_this4.read_time_inference(net);},50);this.setState({ID:Interval_ID});this.setState({real_time_inferencing:true});case 12:case\"end\":return _context7.stop();}}},_callee7,this);}));function runHandpose(){return _runHandpose.apply(this,arguments);}return runHandpose;}()},{key:\"read_time_inference\",value:function(){var _read_time_inference=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(net){var _this5=this;var video,videoWidth,videoHeight,hand,ctx;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:if(this.state.wait){this.setState({wait_till:Date.now()+3000});//await this.sleep(3000);\nthis.setState({wait:false});}if(!(typeof this.webcamRef.current!==\"undefined\"&&this.webcamRef.current!==null&&this.webcamRef.current.video.readyState===4)){_context8.next=16;break;}video=this.webcamRef.current.video;videoWidth=this.webcamRef.current.video.videoWidth;videoHeight=this.webcamRef.current.video.videoHeight;this.webcamRef.current.video.width=videoWidth;this.webcamRef.current.video.height=videoHeight;this.canvasRef.current.width=videoWidth;this.canvasRef.current.height=videoHeight;_context8.next=11;return net.estimateHands(video);case 11:hand=_context8.sent;ctx=this.canvasRef.current.getContext(\"2d\");this.setState({ctx:ctx});//check if hand exist, if yes, drawhand\nif(hand.length>0)drawHand(hand,ctx);//check if waiting\nif(Date.now()<this.state.wait_till){console.log(\"Waiting till \",this.state.wait_till);//count down 3, 2, 1\nif(this.state.wait_till-Date.now()<1000)writeText(ctx,{text:'1',x:180,y:70});else if(this.state.wait_till-Date.now()<2000)writeText(ctx,{text:'2',x:180,y:70});else if(this.state.wait_till-Date.now()<3000)writeText(ctx,{text:'3',x:180,y:70});}else{if(hand.length>0){hand.forEach(function(prediction){_this5.setState({dead_frame:0});var landmarks=prediction.landmarks;var pawn_dist=_this5.norm(landmarks[0],landmarks[17]);var current_moment=(Date.now()-_this5.state.startAt)/1000;if(_this5.state.finger_done===false){var index_dist=_this5.norm(landmarks[4],landmarks[8]);index_dist=index_dist/pawn_dist;_this5.setState({pawn_dist_array:[].concat(_toConsumableArray(_this5.state.pawn_dist_array),[pawn_dist])});_this5.setState({dist_array:[].concat(_toConsumableArray(_this5.state.dist_array),[index_dist])});_this5.setState({dist_time_array:[].concat(_toConsumableArray(_this5.state.dist_time_array),[current_moment])});var threshold=0.5;if(_this5.state.dist_array.length>20){var j=1;var avg=0.0;for(j=1;j<=20;j++){avg+=_this5.state.dist_array[_this5.state.dist_array.length-j];}threshold=avg/40.0+threshold/2.0;console.log(threshold);}if(index_dist>=threshold+0.01){_this5.setState({index_passed:1});}if(index_dist<threshold-0.01&&_this5.state.index_passed===1){_this5.setState({index_passed:0});_this5.setState({tap_count:[].concat(_toConsumableArray(_this5.state.tap_count),[current_moment])});}}if(_this5.state.finger_done===true&&_this5.state.rotate_done===false){var rotate_dist=(landmarks[2][0]-landmarks[17][0])/pawn_dist;_this5.setState({pawn_rotate_array:[].concat(_toConsumableArray(_this5.state.pawn_rotate_array),[pawn_dist])});_this5.setState({rotate_array:[].concat(_toConsumableArray(_this5.state.rotate_array),[rotate_dist])});_this5.setState({rotate_time_array:[].concat(_toConsumableArray(_this5.state.rotate_time_array),[current_moment])});if(_this5.state.rotate_passed===0){if(rotate_dist>=0.25)_this5.setState({rotate_passed:1});if(rotate_dist<=-0.25)_this5.setState({rotate_passed:-1});}if(_this5.state.rotate_passed===1&&rotate_dist<=-0.5){_this5.setState({rotate_passed:-1});}if(_this5.state.rotate_passed===-1&&rotate_dist>=0.5){_this5.setState({rotate_passed:1});_this5.setState({rotate_count:[].concat(_toConsumableArray(_this5.state.rotate_count),[current_moment])});}}if(_this5.state.rotate_done===true&&_this5.state.fist_done===false){var fist_dist=(landmarks[8][1]-landmarks[5][1]+(landmarks[12][1]-landmarks[9][1])+(landmarks[16][1]-landmarks[13][1])+(landmarks[20][1]-landmarks[17][1]))/(4*pawn_dist);_this5.setState({pawn_fist_array:[].concat(_toConsumableArray(_this5.state.pawn_fist_array),[pawn_dist])});_this5.setState({fist_array:[].concat(_toConsumableArray(_this5.state.fist_array),[fist_dist])});_this5.setState({fist_time_array:[].concat(_toConsumableArray(_this5.state.fist_time_array),[current_moment])});if(fist_dist>=0.0){_this5.setState({fist_passed:1});}if(fist_dist<-0.4&&_this5.state.fist_passed===1){_this5.setState({fist_passed:0});_this5.setState({fist_count:[].concat(_toConsumableArray(_this5.state.fist_count),[current_moment])});}}});}else{if(this.state.dead_frame>9)writeText(ctx,{text:'Hand Off Screen',x:180,y:70});this.setState({dead_frame:this.state.dead_frame+1});}}case 16:case\"end\":return _context8.stop();}}},_callee8,this);}));function read_time_inference(_x6){return _read_time_inference.apply(this,arguments);}return read_time_inference;}()},{key:\"stop_tapping\",value:function(){var _stop_tapping=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:this.setState({finger_done:true});this.setState({wait:true});case 2:case\"end\":return _context9.stop();}}},_callee9,this);}));function stop_tapping(){return _stop_tapping.apply(this,arguments);}return stop_tapping;}()},{key:\"stop_rotating\",value:function(){var _stop_rotating=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(){return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:this.setState({rotate_done:true});this.setState({wait:true});case 2:case\"end\":return _context10.stop();}}},_callee10,this);}));function stop_rotating(){return _stop_rotating.apply(this,arguments);}return stop_rotating;}()},{key:\"stop_real_time_inference\",value:function stop_real_time_inference(){clearInterval(this.state.ID);this.setState({real_time_inferencing:false,finger_done:false,rotate_done:false,fist_done:false});this.compose_chart();}},{key:\"record_video\",value:function(){var _record_video=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(){var _this6=this;var count,ctx,Interval_ID;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:this.setState({startAt:Date.now()});count=0;ctx=this.canvasRef.current.getContext(\"2d\");writeText(ctx,{text:'Loading',x:180,y:70});//require('@tensorflow/tfjs-backend-webgl');\n//const net = await handpose.load();\nctx.clearRect(0,0,this.canvasRef.current.width,this.canvasRef.current.height);this.setState({ctx:ctx});console.log(\"Handpose model loaded.\");Interval_ID=setInterval(function(){_this6.concat_frame(count,net,ctx);count=(count+1)%20;},50);this.setState({ID:Interval_ID});this.setState({recording:true});case 10:case\"end\":return _context11.stop();}}},_callee11,this);}));function record_video(){return _record_video.apply(this,arguments);}return record_video;}()},{key:\"concat_frame\",value:function(){var _concat_frame=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(count,net,ctx){var current_moment,image,img;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:if(this.state.wait){this.setState({wait_till:Date.now()+3000});//await this.sleep(3000);\nthis.setState({wait:false});}if(typeof this.webcamRef.current!==\"undefined\"&&this.webcamRef.current!==null&&this.webcamRef.current.video.readyState===4){if(Date.now()<this.state.wait_till){console.log(\"Waiting till \",this.state.wait_till);//count down 3, 2, 1\nctx.clearRect(0,0,this.canvasRef.current.width,this.canvasRef.current.height);if(this.state.wait_till-Date.now()<1000)writeText(ctx,{text:'1',x:180,y:70});else if(this.state.wait_till-Date.now()<2000)writeText(ctx,{text:'2',x:180,y:70});else if(this.state.wait_till-Date.now()<3000)writeText(ctx,{text:'3',x:180,y:70});}else{ctx.clearRect(0,0,this.canvasRef.current.width,this.canvasRef.current.height);current_moment=(Date.now()-this.state.startAt)/1000;image=this.webcamRef.current.getScreenshot();img=document.createElement(\"img\");img.onload=function(){if(this.state.finger_done===false){this.setState({dist_record:[].concat(_toConsumableArray(this.state.dist_record),[img])});this.setState({dist_time_record:[].concat(_toConsumableArray(this.state.dist_time_record),[current_moment])});}else if(this.state.finger_done===true&&this.state.rotate_done===false){this.setState({rotate_record:[].concat(_toConsumableArray(this.state.rotate_record),[img])});this.setState({rotate_time_record:[].concat(_toConsumableArray(this.state.rotate_time_record),[current_moment])});}else if(this.state.rotate_done===true&&this.state.fist_done===false){this.setState({fist_record:[].concat(_toConsumableArray(this.state.fist_record),[img])});this.setState({fist_time_record:[].concat(_toConsumableArray(this.state.fist_time_record),[current_moment])});}//if (count === 0) this.record_estimateHands(img, net, ctx);\n}.bind(this);img.src=image;}}case 2:case\"end\":return _context12.stop();}}},_callee12,this);}));function concat_frame(_x7,_x8,_x9){return _concat_frame.apply(this,arguments);}return concat_frame;}()},{key:\"inference\",value:function(){var _inference=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(){var _this7=this;var net,_loop,i,_loop2,_i2,_loop3,_i3;return _regeneratorRuntime.wrap(function _callee13$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:require('@tensorflow/tfjs-backend-webgl');_context16.next=3;return handpose.load();case 3:net=_context16.sent;console.log(\"Handpose model loaded.\");// Run prediction on recorded tapping data\n_loop=/*#__PURE__*/_regeneratorRuntime.mark(function _loop(i){var hand;return _regeneratorRuntime.wrap(function _loop$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return net.estimateHands(_this7.state.dist_record[i]);case 2:hand=_context13.sent;if(hand.length>0){hand.forEach(function(prediction){var landmarks=prediction.landmarks;var pawn_dist=_this7.norm(landmarks[0],landmarks[17]);var index_dist=_this7.norm(landmarks[4],landmarks[8]);index_dist=index_dist/pawn_dist;var threshold=0.5;if(_this7.state.dist_array.length>20){var j=1;var avg=0.0;for(j=1;j<=20;j++){avg+=_this7.state.dist_array[_this7.state.dist_array.length-j];}threshold=avg/40.0+threshold/2.0;console.log(threshold);}_this7.setState({pawn_dist_array:[].concat(_toConsumableArray(_this7.state.pawn_dist_array),[pawn_dist])});_this7.setState({dist_array:[].concat(_toConsumableArray(_this7.state.dist_array),[index_dist])});_this7.setState({dist_time_array:[].concat(_toConsumableArray(_this7.state.dist_time_array),[_this7.state.dist_time_record[i]])});if(index_dist>=threshold+0.01){_this7.setState({index_passed:1});}if(index_dist<threshold-0.01&&_this7.state.index_passed===1){_this7.setState({index_passed:0});_this7.setState({tap_count:[].concat(_toConsumableArray(_this7.state.tap_count),[_this7.state.dist_time_record[i]])});}console.log(\"INDEX COUNT:\",_this7.state.tap_count);});}case 4:case\"end\":return _context13.stop();}}},_loop);});i=0;case 7:if(!(i<this.state.dist_record.length)){_context16.next=12;break;}return _context16.delegateYield(_loop(i),\"t0\",9);case 9:i++;_context16.next=7;break;case 12:_loop2=/*#__PURE__*/_regeneratorRuntime.mark(function _loop2(_i2){var hand;return _regeneratorRuntime.wrap(function _loop2$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return net.estimateHands(_this7.state.rotate_record[_i2]);case 2:hand=_context14.sent;if(hand.length>0){hand.forEach(function(prediction){var landmarks=prediction.landmarks;var pawn_dist=_this7.norm(landmarks[0],landmarks[17]);var rotate_dist=(landmarks[2][0]-landmarks[17][0])/pawn_dist;_this7.setState({pawn_rotate_array:[].concat(_toConsumableArray(_this7.state.pawn_rotate_array),[pawn_dist])});_this7.setState({rotate_array:[].concat(_toConsumableArray(_this7.state.rotate_array),[rotate_dist])});_this7.setState({rotate_time_array:[].concat(_toConsumableArray(_this7.state.rotate_time_array),[_this7.state.rotate_time_record[_i2]])});if(_this7.state.rotate_passed===0){if(rotate_dist>=0.5)_this7.setState({rotate_passed:1});if(rotate_dist<=-0.5)_this7.setState({rotate_passed:-1});}if(_this7.state.rotate_passed===1&&rotate_dist<=-0.5){_this7.setState({rotate_passed:-1});}if(_this7.state.rotate_passed===-1&&rotate_dist>=0.5){_this7.setState({rotate_passed:1});_this7.setState({rotate_count:[].concat(_toConsumableArray(_this7.state.rotate_count),[_this7.state.rotate_time_record[_i2]])});}console.log(\"ROTATE COUNT:\",_this7.state.rotate_count);});}case 4:case\"end\":return _context14.stop();}}},_loop2);});_i2=0;case 14:if(!(_i2<this.state.rotate_record.length)){_context16.next=19;break;}return _context16.delegateYield(_loop2(_i2),\"t1\",16);case 16:_i2++;_context16.next=14;break;case 19:_loop3=/*#__PURE__*/_regeneratorRuntime.mark(function _loop3(_i3){var hand;return _regeneratorRuntime.wrap(function _loop3$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:_context15.next=2;return net.estimateHands(_this7.state.fist_record[_i3]);case 2:hand=_context15.sent;if(hand.length>0){hand.forEach(function(prediction){var landmarks=prediction.landmarks;var pawn_dist=_this7.norm(landmarks[0],landmarks[17]);var fist_dist=(landmarks[8][1]-landmarks[5][1]+(landmarks[12][1]-landmarks[9][1])+(landmarks[16][1]-landmarks[13][1])+(landmarks[20][1]-landmarks[17][1]))/(4*pawn_dist);_this7.setState({pawn_fist_array:[].concat(_toConsumableArray(_this7.state.pawn_fist_array),[pawn_dist])});_this7.setState({fist_array:[].concat(_toConsumableArray(_this7.state.fist_array),[fist_dist])});_this7.setState({fist_time_array:[].concat(_toConsumableArray(_this7.state.fist_time_array),[_this7.state.fist_time_record[_i3]])});if(fist_dist>=0.0){_this7.setState({fist_passed:1});}if(fist_dist<-0.4&&_this7.state.fist_passed===1){_this7.setState({fist_passed:0});_this7.setState({fist_count:[].concat(_toConsumableArray(_this7.state.fist_count),[_this7.state.fist_time_record[_i3]])});}console.log(\"FIST COUNT:\",_this7.state.fist_count);});}case 4:case\"end\":return _context15.stop();}}},_loop3);});_i3=0;case 21:if(!(_i3<this.state.fist_record.length)){_context16.next=26;break;}return _context16.delegateYield(_loop3(_i3),\"t2\",23);case 23:_i3++;_context16.next=21;break;case 26:this.setState({record:[]});case 27:case\"end\":return _context16.stop();}}},_callee13,this);}));function inference(){return _inference.apply(this,arguments);}return inference;}()},{key:\"stop_record\",value:function(){var _stop_record=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee14(){return _regeneratorRuntime.wrap(function _callee14$(_context17){while(1){switch(_context17.prev=_context17.next){case 0:clearInterval(this.state.ID);_context17.next=3;return this.inference();case 3:this.setState({recording:false,finger_done:false,rotate_done:false,fist_done:false});this.compose_chart();case 5:case\"end\":return _context17.stop();}}},_callee14,this);}));function stop_record(){return _stop_record.apply(this,arguments);}return stop_record;}()},{key:\"render\",value:function render(){var videoConstraints={facingMode:this.state.facingMode};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsxs(\"header\",{className:\"App-header\",children:[/*#__PURE__*/_jsx(Webcam,{ref:this.webcamRef,videoConstraints:videoConstraints,style:{position:\"absolute\",marginLeft:\"auto\",marginRight:\"auto\",left:0,right:0,textAlign:\"center\",zindex:9,width:\"auto\",height:\"auto\"}}),/*#__PURE__*/_jsx(\"canvas\",{ref:this.canvasRef,style:{position:\"absolute\",marginLeft:\"auto\",marginRight:\"auto\",left:0,right:0,textAlign:\"center\",zindex:9,width:\"auto\",height:\"auto\"}})]}),this.state.button_mode?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:this.increment_tap1,id:\"button1\",children:\"Index Finger\"}),/*#__PURE__*/_jsx(\"button\",{onClick:this.increment_tap2,id:\"button2\",children:\"Middle Finger\"})]}):/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsxs(\"div\",{children:[this.state.real_time_inferencing?this.state.finger_done?this.state.rotate_done?/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:this.stop_real_time_inference,children:\"Calculate Result\"}):/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:this.stop_rotating,children:\"Finish Rotating\"}):/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",onClick:this.stop_tapping,children:\"Finish Tapping\"}):/*#__PURE__*/_jsx(Button,{disabled:this.state.recording,variant:\"contained\",color:\"primary\",onClick:this.runHandpose,children:\"Starting Real Time Inference\"}),this.state.recording?this.state.finger_done?this.state.rotate_done?/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"secondary\",onClick:this.stop_record,children:\"Calculate Result\"}):/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"secondary\",onClick:this.stop_rotating,children:\"Finish Rotating\"}):/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"secondary\",onClick:this.stop_tapping,children:\"Finish Tapping\"}):/*#__PURE__*/_jsx(Button,{disabled:this.state.real_time_inferencing,variant:\"contained\",color:\"secondary\",onClick:this.record_video,children:\"Starting Recording\"}),/*#__PURE__*/_jsx(Button,{disabled:this.state.recording||this.state.real_time_inferencing,variant:\"outlined\",color:\"secondary\",onClick:this.reset_counter,children:\"Reset All\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"real_measurement\",onChange:this.compose_chart,step:\"0.001\",min:\"0\",max:\"20\"}),/*#__PURE__*/_jsx(\"button\",{disabled:!this.state.chart_ready,onClick:this.switch_style,children:\"Switch Chart Style\"}),/*#__PURE__*/_jsx(\"button\",{onClick:this.switch_cam,children:\"Switch Camera\"}),/*#__PURE__*/_jsx(\"button\",{disabled:this.state.recording||this.state.real_time_inferencing,onClick:this.runPosenet,children:\"PoseNet\"}),/*#__PURE__*/_jsx(\"button\",{disabled:this.state.recording||this.state.real_time_inferencing,onClick:this.runFacemesh,children:\"Facemesh\"}),/*#__PURE__*/_jsx(\"button\",{disabled:this.state.recording||this.state.real_time_inferencing,onClick:this.switch_button,children:\"Switch On/Off Button\"}),/*#__PURE__*/_jsxs(\"h5\",{children:[\"Finger Tapping Count:\",this.state.tap_count.length,\"\\xA0\\xA0\\xA0\\xA0 Rotate Count:\",this.state.rotate_count.length,\"\\xA0\\xA0\\xA0\\xA0 Gripping Count: \",this.state.fist_count.length]}),/*#__PURE__*/_jsxs(\"div\",{children:[this.state.chart_ready?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Line,{data:this.state.chart_data1}),/*#__PURE__*/_jsx(Line,{data:this.state.chart_data2}),/*#__PURE__*/_jsx(Line,{data:this.state.chart_data3})]}):/*#__PURE__*/_jsx(\"div\",{}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"upload-json\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"upload-weights\"})})]})]});}}]);return App;}(React.Component);export default App;","map":{"version":3,"sources":["C:/Users/wongh/finger/src/App.js"],"names":["React","Button","handpose","posenet","facemesh","Webcam","drawHand","writeText","drawKeypoints","drawSkeleton","drawMesh","sqrt","pow","Line","App","props","sleep","milliseconds","Promise","resolve","setTimeout","record_estimateHands","img","net","ctx","estimateHands","hand","console","log","length","setState","dead_frame","state","text","x","y","ID","tap_count","rotate_count","fist_count","index_passed","rotate_passed","last_pressed","real_time_inferencing","recording","button_mode","chart_ready","finger_done","rotate_done","fist_done","pawn_dist_array","pawn_rotate_array","pawn_fist_array","dist_array","dist_time_array","dist_record","dist_time_record","rotate_array","rotate_time_array","rotate_record","rotate_time_record","fist_array","fist_time_array","fist_record","fist_time_record","gait_record","gait_time_record","chart_data1","chart_data2","chart_data3","wait","wait_till","startAt","Date","now","raw","facingMode","webcamRef","createRef","canvasRef","videoConstraints","runHandpose","bind","stop_real_time_inference","stop_tapping","stop_rotating","stop_record","record_video","concat_frame","inference","reset_counter","increment_tap1","increment_tap2","switch_button","compose_chart","runPosenet","read_time_posenet","runFacemesh","read_time_facemesh","switch_style","switch_cam","require","load","Interval_ID","setInterval","current","video","readyState","videoWidth","videoHeight","width","height","estimateFaces","face","getContext","estimateSinglePose","pose","time_array_1","count_array_1","time_array_2","count_array_2","time_array_3","count_array_3","real_dist","document","getElementById","value","i","tmp","start","end","count","temp_max","includes","time_value","tc","data1","labels","datasets","label","fill","lineTension","backgroundColor","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","pointBorderColor","pointBackgroundColor","pointBorderWidth","pointHoverRadius","pointHoverBackgroundColor","pointHoverBorderColor","pointHoverBorderWidth","pointRadius","pointHitRadius","data","data2","data3","current_moment","lm1","lm2","clearInterval","clearRect","read_time_inference","forEach","prediction","landmarks","pawn_dist","norm","index_dist","threshold","j","avg","rotate_dist","fist_dist","fist_passed","image","getScreenshot","createElement","onload","src","record","position","marginLeft","marginRight","left","right","textAlign","zindex","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport Button from '@material-ui/core/Button';\nimport * as handpose from \"@tensorflow-models/handpose\";\nimport * as posenet from \"@tensorflow-models/posenet\";\nimport * as facemesh from \"@tensorflow-models/facemesh\";\n//import * as tf from '@tensorflow/tfjs-core';\nimport Webcam from \"react-webcam\";\nimport \"./App.css\";\nimport { drawHand, writeText, drawKeypoints, drawSkeleton, drawMesh } from \"./utilities\";\nimport { sqrt, pow } from \"mathjs\"\nimport {Line} from 'react-chartjs-2';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      ID : 0,\n      tap_count : [],\n      rotate_count : [],\n      fist_count : [],\n      index_passed : 0,\n      rotate_passed : 0,\n      last_pressed:0,\n      real_time_inferencing:false,\n      recording:false,\n      button_mode:false,\n      chart_ready:false,\n      finger_done : false,\n      rotate_done : false,\n      fist_done : false,\n      pawn_dist_array : [],\n      pawn_rotate_array : [],\n      pawn_fist_array : [],\n      dist_array : [],\n      dist_time_array : [],\n      dist_record : [],\n      dist_time_record : [],\n      rotate_array : [],\n      rotate_time_array : [],\n      rotate_record : [],\n      rotate_time_record : [],\n      fist_array : [],\n      fist_time_array : [],\n      fist_record : [],\n      fist_time_record : [],\n      gait_record : [],\n      gait_time_record : [],\n      chart_data1 : null,\n      chart_data2 : null,\n      chart_data3 : null,\n      wait : false,\n      wait_till : 0,\n      startAt: Date.now(),\n      dead_frame: 0,\n      ctx: null,\n      raw: false,\n      facingMode: \"user\",\n    };\n    this.webcamRef = React.createRef(null);\n    this.canvasRef = React.createRef(null);\n    this.videoConstraints = {facingMode: \"user\"};\n    this.runHandpose = this.runHandpose.bind(this);\n    this.stop_real_time_inference = this.stop_real_time_inference.bind(this);\n    this.stop_tapping = this.stop_tapping.bind(this);\n    this.stop_rotating = this.stop_rotating.bind(this);\n    this.stop_record = this.stop_record.bind(this);\n    this.record_video = this.record_video.bind(this);\n    this.concat_frame = this.concat_frame.bind(this);\n    this.inference = this.inference.bind(this);\n    this.reset_counter = this.reset_counter.bind(this);\n    this.increment_tap1 = this.increment_tap1.bind(this);\n    this.increment_tap2 = this.increment_tap2.bind(this);\n    this.switch_button = this.switch_button.bind(this);\n    this.compose_chart = this.compose_chart.bind(this);\n    this.runPosenet = this.runPosenet.bind(this);\n    this.read_time_posenet = this.read_time_posenet.bind(this);\n    this.runFacemesh = this.runFacemesh.bind(this);\n    this.read_time_facemesh = this.read_time_facemesh.bind(this);\n    this.switch_style = this.switch_style.bind(this);\n    this.switch_cam = this.switch_cam.bind(this);\n  }\n\n  switch_cam(){\n    if (this.state.facingMode === \"user\") this.setState({facingMode: \"environment\"});\n    else if (this.state.facingMode === \"environment\") this.setState({facingMode: \"user\"});\n  }\n\n  async runFacemesh(){\n    require('@tensorflow/tfjs-backend-webgl');\n    const net = await facemesh.load();\n    console.log(\"Facemesh model loaded.\");\n    this.setState({startAt:Date.now()});\n    const Interval_ID = setInterval(() => {\n      this.read_time_facemesh(net);\n    }, 50);\n    this.setState({ID:Interval_ID});\n    this.setState({real_time_inferencing:true});\n  }\n\n  async read_time_facemesh(net) {\n    if (this.state.wait){\n      this.setState({wait_till:Date.now()+3000});\n      //await this.sleep(3000);\n      this.setState({wait:false});\n    }\n    if (\n      typeof this.webcamRef.current !== \"undefined\" &&\n      this.webcamRef.current !== null &&\n      this.webcamRef.current.video.readyState === 4\n    ) {\n      const video = this.webcamRef.current.video;\n      const videoWidth = this.webcamRef.current.video.videoWidth;\n      const videoHeight = this.webcamRef.current.video.videoHeight;\n      this.webcamRef.current.video.width = videoWidth;\n      this.webcamRef.current.video.height = videoHeight;\n      this.canvasRef.current.width = videoWidth;\n      this.canvasRef.current.height = videoHeight;\n      const face = await net.estimateFaces(video);\n      const ctx = this.canvasRef.current.getContext(\"2d\");\n      drawMesh(face, ctx);\n    }\n  }\n\n  async runPosenet(){\n    require('@tensorflow/tfjs-backend-webgl');\n    const net = await posenet.load();\n    console.log(\"PoseNet model loaded.\");\n    this.setState({startAt:Date.now()});\n    const Interval_ID = setInterval(() => {\n      this.read_time_posenet(net);\n    }, 50);\n    this.setState({ID:Interval_ID});\n    this.setState({real_time_inferencing:true});\n  }\n\n  async read_time_posenet(net) {\n    if (this.state.wait){\n      this.setState({wait_till:Date.now()+3000});\n      //await this.sleep(3000);\n      this.setState({wait:false});\n    }\n    if (\n      typeof this.webcamRef.current !== \"undefined\" &&\n      this.webcamRef.current !== null &&\n      this.webcamRef.current.video.readyState === 4\n    ) {\n      const video = this.webcamRef.current.video;\n      const videoWidth = this.webcamRef.current.video.videoWidth;\n      const videoHeight = this.webcamRef.current.video.videoHeight;\n      this.webcamRef.current.video.width = videoWidth;\n      this.webcamRef.current.video.height = videoHeight;\n      this.canvasRef.current.width = videoWidth;\n      this.canvasRef.current.height = videoHeight;\n      const pose = await net.estimateSinglePose(video);\n      const ctx = this.canvasRef.current.getContext(\"2d\");\n      drawKeypoints(pose[\"keypoints\"], 0.6, ctx);\n      drawSkeleton(pose[\"keypoints\"], 0.7, ctx);\n    }\n  }\n\n  async switch_style(){\n    await this.setState({raw: !this.state.raw});\n    this.compose_chart();\n  }\n\n  compose_chart(){\n    let time_array_1 = [];\n    let count_array_1 = [];\n    let time_array_2 = [];\n    let count_array_2 = [];\n    let time_array_3 = [];\n    let count_array_3 = [];\n\n    let real_dist = document.getElementById(\"real_measurement\").value;\n    // change to real life measurement\n\n    if (this.state.raw){\n      time_array_1 = [...this.state.dist_time_array];\n      count_array_1 = [...this.state.dist_array];\n      time_array_2 = [...this.state.rotate_time_array];\n      count_array_2 = [...this.state.rotate_array];\n      time_array_3 = [...this.state.fist_time_array];\n      count_array_3 = [...this.state.fist_array];\n      if (real_dist > 0.0001){\n        let i = 0;\n        let tmp = 0;\n        for (i = 0; i < count_array_1.length; i++){\n          tmp = count_array_1[i];\n          count_array_1[i] = tmp*real_dist;\n        }\n        for (i = 0; i < count_array_2.length; i++){\n          tmp = count_array_2[i];\n          count_array_2[i] = tmp*real_dist;\n        }\n        for (i = 0; i < count_array_3.length; i++){\n          tmp = count_array_3[i];\n          count_array_3[i] = tmp*real_dist;\n        }\n      }\n    }\n    else{\n      // Recalculate Tapping Data\n      let start = this.state.dist_time_array[0];\n      let end = this.state.dist_time_array[this.state.dist_time_array.length - 1];\n      while (start + 1.0 < end){\n        time_array_1 = [...time_array_1, start];\n        let count = 0, temp_max = 0;\n        for (let i = 0; i < this.state.dist_array.length; i++){        \n          if (this.state.dist_time_array[i] >= start && this.state.dist_time_array[i] < (start + 1.0)){\n            if (temp_max < this.state.dist_array[i]) temp_max = this.state.dist_array[i];\n            if (this.state.tap_count.includes(this.state.dist_time_array[i])){\n              count += temp_max;\n              temp_max = 0;\n            }\n          }\n        }\n        count_array_1 = [...count_array_1, count];\n        start += 0.1;\n      }\n\n      // Recalculate Rotate Data\n      start = this.state.rotate_time_array[0];\n      end = this.state.rotate_time_array[this.state.rotate_time_array.length - 1];\n      while (start + 5.0 < end){\n        time_array_2 = [...time_array_2, start + 2.5];\n        let count = 0.0;\n        let time_value = 0;\n        for (let tc in this.state.rotate_count){\n          time_value = this.state.rotate_count[tc];\n          if (time_value >= start && time_value < (start + 5.0)){\n            count += 1.0;\n          }\n        }\n        count_array_2 = [...count_array_2, count];\n        start += 0.1;\n      }\n\n      // Recalculate Gripping Data\n      start = this.state.fist_time_array[0];\n      end = this.state.fist_time_array[this.state.fist_time_array.length - 1];\n      while (start + 5.0 < end){\n        time_array_3 = [...time_array_3, start + 2.5];\n        let count = 0.0;\n        let time_value = 0;\n        for (let tc in this.state.fist_count){\n          time_value = this.state.fist_count[tc];\n          if (time_value >= start && time_value < (start + 5.0)){\n            count += 1.0;\n          }\n        }\n        count_array_3 = [...count_array_3, count];\n        start += 0.1;\n      }\n    }\n      \n    const data1 = {\n      labels: time_array_1,\n      datasets: [        \n        {\n          label: 'Tapping',\n          fill: false,\n          lineTension: 0.3,\n          backgroundColor: 'rgba(75,192,192,0.4)',\n          borderColor: 'rgba(75,192,192,1)',\n          borderCapStyle: 'butt',\n          borderDash: [],\n          borderDashOffset: 0.0,\n          borderJoinStyle: 'miter',\n          pointBorderColor: 'rgba(75,192,192,1)',\n          pointBackgroundColor: '#fff',\n          pointBorderWidth: 1,\n          pointHoverRadius: 5,\n          pointHoverBackgroundColor: 'rgba(75,192,192,1)',\n          pointHoverBorderColor: 'rgba(220,220,220,1)',\n          pointHoverBorderWidth: 2,\n          pointRadius: 1,\n          pointHitRadius: 10,\n          data: count_array_1\n        }\n      ]\n    };\n    const data2 = {\n      labels: time_array_2,\n      datasets: [        \n        {\n          label: 'Rotation',\n          fill: false,\n          lineTension: 0.1,\n          backgroundColor: 'rgba(192,75,192,0.4)',\n          borderColor: 'rgba(192,75,192,1)',\n          borderCapStyle: 'butt',\n          borderDash: [],\n          borderDashOffset: 0.0,\n          borderJoinStyle: 'miter',\n          pointBorderColor: 'rgba(192,75,192,1)',\n          pointBackgroundColor: '#fff',\n          pointBorderWidth: 1,\n          pointHoverRadius: 5,\n          pointHoverBackgroundColor: 'rgba(192,75,192,1)',\n          pointHoverBorderColor: 'rgba(220,220,220,1)',\n          pointHoverBorderWidth: 2,\n          pointRadius: 1,\n          pointHitRadius: 10,\n          data: count_array_2 \n        },\n      ]\n    };\n    const data3 = {\n      labels: time_array_3,\n      datasets: [        \n        {\n          label: 'Fist',\n          fill: false,\n          lineTension: 0.1,\n          backgroundColor: 'rgba(192,192,75,0.4)',\n          borderColor: 'rgba(192,192,75,1)',\n          borderCapStyle: 'butt',\n          borderDash: [],\n          borderDashOffset: 0.0,\n          borderJoinStyle: 'miter',\n          pointBorderColor: 'rgba(192,192,75,1)',\n          pointBackgroundColor: '#fff',\n          pointBorderWidth: 1,\n          pointHoverRadius: 5,\n          pointHoverBackgroundColor: 'rgba(192,192,75,1)',\n          pointHoverBorderColor: 'rgba(220,220,220,1)',\n          pointHoverBorderWidth: 2,\n          pointRadius: 1,\n          pointHitRadius: 10,\n          data: count_array_3\n        }\n      ]\n    };\n\n    this.setState({chart_data1:data1});\n    this.setState({chart_data2:data2});\n    this.setState({chart_data3:data3});\n    this.setState({chart_ready:true});\n  }\n\n  switch_button(){\n    if (this.state.button_mode === true){\n      this.setState({button_mode:false});\n      this.compose_chart();\n    }\n    else{\n      this.setState({button_mode:true})\n    }\n  }\n\n  increment_tap1(){\n    if (this.state.last_pressed !== 1){\n      let current_moment = (Date.now() - this.state.startAt)/1000\n      this.setState({last_pressed:1})\n      this.setState({dist_array:[...this.state.dist_array, 1.0]});\n      this.setState({dist_time_array:[...this.state.dist_time_array, current_moment]});\n      this.setState({tap_count:[...this.state.tap_count, current_moment]});\n    }\n  }\n\n  increment_tap2(){\n    if (this.state.last_pressed !== 2){\n      let current_moment = (Date.now() - this.state.startAt)/1000\n      this.setState({last_pressed:2})\n      this.setState({dist_array:[...this.state.dist_array, 1.0]});\n      this.setState({dist_time_array:[...this.state.dist_time_array, current_moment]});\n      this.setState({tap_count:[...this.state.tap_count, current_moment]});\n    }\n  }\n\n  norm(lm1, lm2){\n    return sqrt(pow(lm1[0]-lm2[0], 2)+pow(lm1[1]-lm2[1], 2))\n  }\n\n  reset_counter(){\n    clearInterval(this.state.ID);\n    if (this.state.ctx != null) this.state.ctx.clearRect(0,0, this.canvasRef.current.width, this.canvasRef.current.height);\n    this.setState({\n      ID : 0,\n      tap_count : [],\n      rotate_count : [],\n      fist_count : [],\n      index_passed : 0,\n      rotate_passed : 0,\n      last_pressed:0,\n      real_time_inferencing:false,\n      recording:false,\n      button_mode:false,\n      chart_ready:false,\n      finger_done : false,\n      rotate_done : false,\n      fist_done : false,\n      dist_array : [],\n      dist_time_array : [],\n      dist_record : [],\n      dist_time_record : [],\n      rotate_array : [],\n      rotate_time_array : [],\n      rotate_record : [],\n      rotate_time_record : [],\n      fist_array : [],\n      fist_time_array : [],\n      fist_record : [],\n      fist_time_record : [],\n      gait_record : [],\n      gait_time_record : [],\n      chart_data1 : null,\n      chart_data2 : null,\n      chart_data3 : null,\n      wait : false,\n      wait_till : 0,\n      startAt: Date.now(),\n      dead_frame: 0,\n    });\n  }\n\n  sleep = (milliseconds) => {\n    return new Promise(resolve => setTimeout(resolve, milliseconds))\n  }\n\n  async runHandpose() {\n    const ctx = this.canvasRef.current.getContext(\"2d\");\n    writeText(ctx, { text: 'Loading', x: 180, y: 70 });\n    require('@tensorflow/tfjs-backend-webgl');\n    const net = await handpose.load();\n    ctx.clearRect(0,0, this.canvasRef.current.width, this.canvasRef.current.height);\n    //const uploadJSONInput = document.getElementById('upload-json');\n    //const uploadWeightsInput = document.getElementById('upload-weights');\n    //const model = await tf.loadLayersModel(tf.io.browserFiles([uploadJSONInput.files[0], uploadWeightsInput.files[0]]));\n    console.log(\"Handpose model loaded.\");\n    this.setState({startAt:Date.now()});\n    const Interval_ID = setInterval(() => {\n      this.read_time_inference(net);\n    }, 50);\n    this.setState({ID:Interval_ID});\n    this.setState({real_time_inferencing:true});\n  };\n\n  async read_time_inference(net) {\n    if (this.state.wait){\n      this.setState({wait_till:Date.now()+3000});\n      //await this.sleep(3000);\n      this.setState({wait:false});\n    }\n    if (\n      typeof this.webcamRef.current !== \"undefined\" &&\n      this.webcamRef.current !== null &&\n      this.webcamRef.current.video.readyState === 4\n    ) {\n      const video = this.webcamRef.current.video;\n      const videoWidth = this.webcamRef.current.video.videoWidth;\n      const videoHeight = this.webcamRef.current.video.videoHeight;\n      this.webcamRef.current.video.width = videoWidth;\n      this.webcamRef.current.video.height = videoHeight;\n      this.canvasRef.current.width = videoWidth;\n      this.canvasRef.current.height = videoHeight;\n      const hand = await net.estimateHands(video);\n      const ctx = this.canvasRef.current.getContext(\"2d\");\n      this.setState({ctx:ctx});\n\n      //check if hand exist, if yes, drawhand\n      if (hand.length > 0) drawHand(hand, ctx);\n      \n      //check if waiting\n      if (Date.now() < this.state.wait_till){\n        console.log(\"Waiting till \", this.state.wait_till);\n        //count down 3, 2, 1\n        if (this.state.wait_till - Date.now() < 1000) writeText(ctx, { text: '1', x: 180, y: 70 });\n        else if (this.state.wait_till - Date.now() < 2000) writeText(ctx, { text: '2', x: 180, y: 70 });\n        else if (this.state.wait_till - Date.now() < 3000) writeText(ctx, { text: '3', x: 180, y: 70 });\n      }\n      else {\n        if (hand.length > 0){\n          hand.forEach((prediction) => {\n            this.setState({dead_frame: 0});\n            const landmarks = prediction.landmarks\n\n            let pawn_dist = this.norm(landmarks[0], landmarks[17]);\n            let current_moment = (Date.now() - this.state.startAt)/1000\n\n            if (this.state.finger_done === false){\n              let index_dist = this.norm(landmarks[4], landmarks[8]);\n              index_dist = index_dist/pawn_dist\n              this.setState({pawn_dist_array:[...this.state.pawn_dist_array, pawn_dist]});\n              this.setState({dist_array:[...this.state.dist_array, index_dist]});\n              this.setState({dist_time_array:[...this.state.dist_time_array, current_moment]});\n              let threshold = 0.5;\n              if (this.state.dist_array.length > 20){\n                let j = 1;\n                let avg = 0.0;\n                for (j = 1; j <= 20; j++) avg += this.state.dist_array[this.state.dist_array.length - j];\n                threshold = avg/40.0 + threshold/2.0;\n                console.log(threshold);\n              }\n              if (index_dist >= (threshold + 0.01)){this.setState({index_passed:1})}\n              if (index_dist < (threshold - 0.01) && this.state.index_passed === 1){\n                this.setState({index_passed:0});\n                this.setState({tap_count:[...this.state.tap_count, current_moment]});\n              }\n            }\n            \n            if (this.state.finger_done === true && this.state.rotate_done === false){\n              let rotate_dist = (landmarks[2][0] - landmarks[17][0]) / pawn_dist;\n              this.setState({pawn_rotate_array:[...this.state.pawn_rotate_array, pawn_dist]});\n              this.setState({rotate_array:[...this.state.rotate_array, rotate_dist]});\n              this.setState({rotate_time_array:[...this.state.rotate_time_array, current_moment]});\n              if (this.state.rotate_passed === 0){\n                if (rotate_dist >= 0.25) this.setState({rotate_passed:1});\n                if (rotate_dist <= -0.25) this.setState({rotate_passed:-1});\n              }\n              if (this.state.rotate_passed === 1 && rotate_dist <= -0.5){\n                this.setState({rotate_passed:-1});\n              }\n              if (this.state.rotate_passed === -1 && rotate_dist >= 0.5){\n                this.setState({rotate_passed:1});\n                this.setState({rotate_count:[...this.state.rotate_count, current_moment]});\n              }\n            }\n\n            if (this.state.rotate_done === true && this.state.fist_done === false){\n              let fist_dist =  ((landmarks[8][1] - landmarks[5][1])+\n                                (landmarks[12][1] - landmarks[9][1])+\n                                (landmarks[16][1] - landmarks[13][1])+\n                                (landmarks[20][1] - landmarks[17][1]))/\n                                (4*pawn_dist)\n              this.setState({pawn_fist_array:[...this.state.pawn_fist_array, pawn_dist]});\n              this.setState({fist_array:[...this.state.fist_array, fist_dist]});\n              this.setState({fist_time_array:[...this.state.fist_time_array, current_moment]});\n              if (fist_dist >= 0.0){this.setState({fist_passed:1})}\n              if (fist_dist < -0.4 && this.state.fist_passed === 1){\n                this.setState({fist_passed:0});\n                this.setState({fist_count:[...this.state.fist_count, current_moment]});\n              }\n            }                  \n          });\n        }\n        else {\n          if (this.state.dead_frame > 9) writeText(ctx, { text: 'Hand Off Screen', x: 180, y: 70 });\n          this.setState({dead_frame: this.state.dead_frame + 1});\n        }\n      }\n    }\n  };\n\n  async stop_tapping() {\n    this.setState({finger_done:true});\n    this.setState({wait:true});\n  }\n\n  async stop_rotating() {\n    this.setState({rotate_done:true});\n    this.setState({wait:true});\n  }\n\n  stop_real_time_inference() {\n    clearInterval(this.state.ID);\n    this.setState({real_time_inferencing:false,\n                   finger_done:false,\n                   rotate_done:false,\n                   fist_done:false});\n    this.compose_chart();\n  }\n\n  async record_video(){\n    this.setState({startAt:Date.now()});\n    let count = 0;\n    const ctx = this.canvasRef.current.getContext(\"2d\");\n    writeText(ctx, { text: 'Loading', x: 180, y: 70 });\n    //require('@tensorflow/tfjs-backend-webgl');\n    //const net = await handpose.load();\n    ctx.clearRect(0,0, this.canvasRef.current.width, this.canvasRef.current.height);\n    this.setState({ctx:ctx});\n    console.log(\"Handpose model loaded.\");\n    const Interval_ID = setInterval(() => {\n      this.concat_frame(count, net, ctx);\n      count = (count + 1)%20;\n    }, 50);\n    this.setState({ID:Interval_ID});\n    this.setState({recording:true});\n  }\n\n  async concat_frame(count, net, ctx) {\n    if (this.state.wait){\n      this.setState({wait_till:Date.now()+3000});\n      //await this.sleep(3000);\n      this.setState({wait:false});\n    }\n    if (\n      typeof this.webcamRef.current !== \"undefined\" &&\n      this.webcamRef.current !== null &&\n      this.webcamRef.current.video.readyState === 4\n    ) {\n      if (Date.now() < this.state.wait_till){\n        console.log(\"Waiting till \", this.state.wait_till);\n        //count down 3, 2, 1\n        ctx.clearRect(0,0, this.canvasRef.current.width, this.canvasRef.current.height);\n        if (this.state.wait_till - Date.now() < 1000) writeText(ctx, { text: '1', x: 180, y: 70 });\n        else if (this.state.wait_till - Date.now() < 2000) writeText(ctx, { text: '2', x: 180, y: 70 });\n        else if (this.state.wait_till - Date.now() < 3000) writeText(ctx, { text: '3', x: 180, y: 70 });\n        \n      }\n      else {\n        ctx.clearRect(0,0, this.canvasRef.current.width, this.canvasRef.current.height);\n        let current_moment = (Date.now() - this.state.startAt)/1000;\n        const image = this.webcamRef.current.getScreenshot();      \n        var img = document.createElement(\"img\");\n        img.onload = function(){\n          if (this.state.finger_done === false){\n            this.setState({dist_record:[...this.state.dist_record, img]});\n            this.setState({dist_time_record:[...this.state.dist_time_record, current_moment]});\n          }\n\n          else if (this.state.finger_done === true && this.state.rotate_done === false){\n            this.setState({rotate_record:[...this.state.rotate_record, img]});\n            this.setState({rotate_time_record:[...this.state.rotate_time_record, current_moment]});\n          }\n\n          else if (this.state.rotate_done === true && this.state.fist_done === false){\n            this.setState({fist_record:[...this.state.fist_record, img]});\n            this.setState({fist_time_record:[...this.state.fist_time_record, current_moment]});\n          }\n\n          //if (count === 0) this.record_estimateHands(img, net, ctx);\n        }.bind(this)\n        img.src = image;\n      }\n    }\n  }\n\n  record_estimateHands = async(img, net, ctx) =>{\n    const hand = await net.estimateHands(img);\n    console.log(hand);\n    if (hand.length > 0) {\n      //drawHand(hand, ctx);   \n      this.setState({dead_frame: 0});\n    }\n    else {\n      if (this.state.dead_frame === 1) writeText(ctx, { text: 'Hand Off Screen', x: 180, y: 70 })\n      this.setState({dead_frame: 1});\n    }\n  }\n\n  async inference() {\n    require('@tensorflow/tfjs-backend-webgl');\n    const net = await handpose.load();\n    console.log(\"Handpose model loaded.\");\n\n    // Run prediction on recorded tapping data\n    for (let i = 0; i<this.state.dist_record.length; i++){\n      const hand = await net.estimateHands(this.state.dist_record[i]);\n      if (hand.length > 0){\n        hand.forEach((prediction) => {\n          const landmarks = prediction.landmarks\n          let pawn_dist = this.norm(landmarks[0], landmarks[17]);\n          let index_dist = this.norm(landmarks[4], landmarks[8]);\n          index_dist = index_dist/pawn_dist\n          let threshold = 0.5;\n          if (this.state.dist_array.length > 20){\n            let j = 1;\n            let avg = 0.0;\n            for (j = 1; j <= 20; j++) avg += this.state.dist_array[this.state.dist_array.length - j];\n            threshold = avg/40.0 + threshold/2.0;\n            console.log(threshold);\n          }\n          this.setState({pawn_dist_array:[...this.state.pawn_dist_array, pawn_dist]});\n          this.setState({dist_array:[...this.state.dist_array, index_dist]});\n          this.setState({dist_time_array:[...this.state.dist_time_array, this.state.dist_time_record[i]]});\n          if (index_dist >= (threshold + 0.01)){this.setState({index_passed:1})}\n          if (index_dist < (threshold - 0.01) && this.state.index_passed === 1){\n            this.setState({index_passed:0});\n            this.setState({tap_count:[...this.state.tap_count, this.state.dist_time_record[i]]});\n          }\n          console.log(\"INDEX COUNT:\", this.state.tap_count);\n        });\n      }\n    }\n\n    // Run prediction on recorded rotation data\n    for (let i = 0; i<this.state.rotate_record.length; i++){\n      const hand = await net.estimateHands(this.state.rotate_record[i]);\n      if (hand.length > 0){\n        hand.forEach((prediction) => {\n          const landmarks = prediction.landmarks\n          let pawn_dist = this.norm(landmarks[0], landmarks[17]);\n          let rotate_dist = (landmarks[2][0] - landmarks[17][0]) / pawn_dist;\n          this.setState({pawn_rotate_array:[...this.state.pawn_rotate_array, pawn_dist]});\n          this.setState({rotate_array:[...this.state.rotate_array, rotate_dist]});\n          this.setState({rotate_time_array:[...this.state.rotate_time_array, this.state.rotate_time_record[i]]});\n          if (this.state.rotate_passed === 0){\n            if (rotate_dist >= 0.5) this.setState({rotate_passed:1});\n            if (rotate_dist <= -0.5) this.setState({rotate_passed:-1});\n          }\n          if (this.state.rotate_passed === 1 && rotate_dist <= -0.5){\n            this.setState({rotate_passed:-1});\n          }\n          if (this.state.rotate_passed === -1 && rotate_dist >= 0.5){\n            this.setState({rotate_passed:1});\n            this.setState({rotate_count:[...this.state.rotate_count, this.state.rotate_time_record[i]]});\n          }\n          console.log(\"ROTATE COUNT:\", this.state.rotate_count);\n        });\n      }\n    }\n\n    // Run prediction on recorded gripping data\n    for (let i = 0; i<this.state.fist_record.length; i++){\n      const hand = await net.estimateHands(this.state.fist_record[i]);\n      if (hand.length > 0){\n        hand.forEach((prediction) => {\n          const landmarks = prediction.landmarks\n          let pawn_dist = this.norm(landmarks[0], landmarks[17]);\n          let fist_dist =  ((landmarks[8][1] - landmarks[5][1])+\n            (landmarks[12][1] - landmarks[9][1])+\n            (landmarks[16][1] - landmarks[13][1])+\n            (landmarks[20][1] - landmarks[17][1]))/\n            (4*pawn_dist)\n          this.setState({pawn_fist_array:[...this.state.pawn_fist_array, pawn_dist]});\n          this.setState({fist_array:[...this.state.fist_array, fist_dist]});\n          this.setState({fist_time_array:[...this.state.fist_time_array, this.state.fist_time_record[i]]});\n          if (fist_dist >= 0.0){this.setState({fist_passed:1})}\n          if (fist_dist < -0.4 && this.state.fist_passed === 1){\n            this.setState({fist_passed:0});\n            this.setState({fist_count:[...this.state.fist_count, this.state.fist_time_record[i]]});\n          }\n          console.log(\"FIST COUNT:\", this.state.fist_count);\n        });\n      }\n    }\n    this.setState({record:[]});\n  }\n\n  async stop_record() {\n    clearInterval(this.state.ID);\n    await this.inference();\n    this.setState({recording:false,\n      finger_done:false,\n      rotate_done:false,\n      fist_done:false});\n    this.compose_chart();\n  }\n\n  \n\n  render(){\n    const videoConstraints = {\n      facingMode: this.state.facingMode\n    };\n    return (\n      <div className=\"App\">\n        <header className=\"App-header\">\n        <Webcam\n          ref={this.webcamRef}\n          videoConstraints={videoConstraints}\n          style={{\n            position: \"absolute\",\n            marginLeft: \"auto\",\n            marginRight: \"auto\",\n            left: 0,\n            right: 0,\n            textAlign: \"center\",\n            zindex: 9,\n            width: \"auto\",\n            height: \"auto\",\n          }}\n        />\n        <canvas\n          ref={this.canvasRef}\n          style={{\n            position: \"absolute\",\n            marginLeft: \"auto\",\n            marginRight: \"auto\",\n            left: 0,\n            right: 0,\n            textAlign: \"center\",\n            zindex: 9,\n            width: \"auto\",\n            height: \"auto\",\n          }}\n        />\n        </header>\n          {this.state.button_mode ? (\n            <div>\n              <button onClick={this.increment_tap1} id=\"button1\">Index Finger</button>\n              <button onClick={this.increment_tap2} id=\"button2\">Middle Finger</button>\n            </div>\n          ) : (\n            <div></div>\n          )}\n\n          <div>\n            {this.state.real_time_inferencing ? (\n              this.state.finger_done ? (\n                this.state.rotate_done ? (\n                  <Button variant=\"contained\" color=\"primary\"  onClick={this.stop_real_time_inference}>Calculate Result</Button>\n                ):(\n                  <Button variant=\"contained\" color=\"primary\"  onClick={this.stop_rotating}>Finish Rotating</Button>\n                )\n              ):(\n                <Button variant=\"contained\" color=\"primary\"  onClick={this.stop_tapping}>Finish Tapping</Button>\n              )            \n            ) : (\n            <Button disabled={this.state.recording} variant=\"contained\" color=\"primary\"  onClick={this.runHandpose}>Starting Real Time Inference</Button>\n            )}\n\n            {this.state.recording ? (\n              this.state.finger_done ? (\n                this.state.rotate_done ? (\n                  <Button variant=\"contained\" color=\"secondary\" onClick={this.stop_record}>Calculate Result</Button>\n                ):(\n                  <Button variant=\"contained\" color=\"secondary\" onClick={this.stop_rotating}>Finish Rotating</Button>\n                )\n              ):(\n                <Button variant=\"contained\" color=\"secondary\" onClick={this.stop_tapping}>Finish Tapping</Button>\n              )            \n            ) : (\n            <Button disabled={this.state.real_time_inferencing} variant=\"contained\" color=\"secondary\" onClick={this.record_video}>Starting Recording</Button>\n            )}\n\n            <Button disabled={this.state.recording||this.state.real_time_inferencing} variant=\"outlined\" color=\"secondary\" onClick={this.reset_counter}>\n              Reset All\n            </Button>\n          </div>\n          \n          <input type=\"number\" id=\"real_measurement\" onChange={this.compose_chart} step=\"0.001\" min='0' max='20'></input>\n          <button disabled={!this.state.chart_ready} onClick={this.switch_style}>Switch Chart Style</button>\n          <button onClick={this.switch_cam}>Switch Camera</button>\n          <button disabled={this.state.recording||this.state.real_time_inferencing} onClick={this.runPosenet}>PoseNet</button>\n          <button disabled={this.state.recording||this.state.real_time_inferencing} onClick={this.runFacemesh}>Facemesh</button>\n          <button disabled={this.state.recording||this.state.real_time_inferencing} onClick={this.switch_button}>Switch On/Off Button</button>       \n            <h5>\n              Finger Tapping Count:{this.state.tap_count.length}&nbsp;&nbsp;&nbsp;&nbsp;\n              Rotate Count:{this.state.rotate_count.length}&nbsp;&nbsp;&nbsp;&nbsp;\n              Gripping Count: {this.state.fist_count.length}\n            </h5>\n          <div>\n            {this.state.chart_ready ? (\n              <div>\n                <Line data={this.state.chart_data1} />\n                <Line data={this.state.chart_data2} />\n                <Line data={this.state.chart_data3} />\n              </div>\n            ) : (\n              <div/>\n            )}\n            <div>\n              <input type=\"file\" id=\"upload-json\"></input>\n            </div>\n            <div>\n              <input type=\"file\" id=\"upload-weights\"></input>\n            </div>\n          </div>\n      </div>\n    );\n  }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}